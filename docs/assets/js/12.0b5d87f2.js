(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{318:function(s,n,a){s.exports=a.p+"assets/img/8c9380dd.8c9380dd.png"},341:function(s,n,a){"use strict";a.r(n);var t=a(4),e=Object(t.a)({},function(){var s=this,n=s.$createElement,t=s._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"ubuntu-扩展-lvm-根目录的方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ubuntu-扩展-lvm-根目录的方法","aria-hidden":"true"}},[s._v("#")]),s._v(" Ubuntu 扩展 LVM 根目录的方法")]),s._v(" "),t("p",[s._v("最近手头一台运行在 Hyper-V 下面抓数据的服务器 (Ubuntu 16.04) 磁盘空间不够了，之前也没有把数据单独放到一个分区，所以只能想办法把根目录给搞大一点。之前没有处理过这样的问题，网上搜了很多资料，现在把拓展方法记录，分享出来。\n"),t("strong",[s._v("建议在操作之前做好备份工作")])]),s._v(" "),t("h2",{attrs:{id:"步骤概览"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#步骤概览","aria-hidden":"true"}},[s._v("#")]),s._v(" 步骤概览")]),s._v(" "),t("ol",[t("li",[s._v("调大物理磁盘")]),s._v(" "),t("li",[s._v("确定要操作的磁盘")]),s._v(" "),t("li",[s._v("扩展 LVM 逻辑分区所在的物理拓展分区")]),s._v(" "),t("li",[s._v("新增 LVM 逻辑分区")]),s._v(" "),t("li",[s._v("新分区合并到相应 Volumn Group")]),s._v(" "),t("li",[s._v("更新文件系统")])]),s._v(" "),t("h1",{attrs:{id:"调大物理磁盘"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#调大物理磁盘","aria-hidden":"true"}},[s._v("#")]),s._v(" 调大物理磁盘")]),s._v(" "),t("p",[s._v("虚拟机关机，然后直接在虚拟机管理里面操作。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(318),alt:"调整磁盘大小"}}),s._v("\n现在把磁盘从 100G 调整到了 300G")]),s._v(" "),t("h2",{attrs:{id:"确定要操作的磁盘"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#确定要操作的磁盘","aria-hidden":"true"}},[s._v("#")]),s._v(" 确定要操作的磁盘")]),s._v(" "),t("p",[s._v("先看下磁盘使用情况，运行命令")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@vm003:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# df -h")]),s._v("\nFilesystem               Size  Used Avail Use% Mounted on\nudev                     3.9G     0  3.9G   0% /dev\ntmpfs                    798M  8.6M  789M   2% /run\n/dev/mapper/Ubuntu-root   94G   88G  1.9G  98% /\ntmpfs                    3.9G     0  3.9G   0% /dev/shm\ntmpfs                    5.0M     0  5.0M   0% /run/lock\ntmpfs                    3.9G     0  3.9G   0% /sys/fs/cgroup\n/dev/sda1                472M  382M   66M  86% /boot\ntmpfs                    100K     0  100K   0% /run/lxcfs/controllers\ntmpfs                    798M     0  798M   0% /run/user/0\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("虽然我们已经把物理磁盘调整到了 300G，但是根目录还是100G的样子，已用 98%")]),s._v(" "),t("p",[s._v("运行命令")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@vm003:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# fdisk -l")]),s._v("\nDisk /dev/sda: 300 GiB, 322122547200 bytes, 629145600 sectors\nUnits: sectors of 1 * 512 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 512 bytes\nSector size "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 512 bytes / 4096 bytes\nI/O size "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum/optimal"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 4096 bytes / 4096 bytes\nDisklabel type: dos\nDisk identifier: 0xa88f1366\n\nDevice     Boot   Start       End   Sectors  Size Id Type\n/dev/sda1  *       2048    999423    997376  487M 83 Linux\n/dev/sda2       1001470 209713151 208711682 99.5G  5 Extended\n/dev/sda5       1001472 209713151 208711680 99.5G 8e Linux LVM\n\nPartition 2 does not start on physical sector boundary.\n\n\nDisk /dev/mapper/Ubuntu-root: 95.5 GiB, 102563315712 bytes, 200318976 sectors\nUnits: sectors of 1 * 512 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 512 bytes\nSector size "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 512 bytes / 4096 bytes\nI/O size "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum/optimal"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 4096 bytes / 4096 bytes\n\n\nDisk /dev/mapper/Ubuntu-swap_1: 4 GiB, 4294967296 bytes, 8388608 sectors\nUnits: sectors of 1 * 512 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 512 bytes\nSector size "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 512 bytes / 4096 bytes\nI/O size "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum/optimal"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 4096 bytes / 4096 bytes\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br")])]),t("p",[s._v("可以看到 "),t("em",[s._v("/dev/sda")]),s._v(" 已经确实被调整到了300GiB，只是系统还没用到。\n也知道了我们要操作 "),t("strong",[s._v("/dev/sda")])]),s._v(" "),t("h1",{attrs:{id:"扩大-lvm-逻辑分区所在的物理分区"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#扩大-lvm-逻辑分区所在的物理分区","aria-hidden":"true"}},[s._v("#")]),s._v(" 扩大 LVM 逻辑分区所在的物理分区")]),s._v(" "),t("p",[s._v("运行命令")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@vm003:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# parted /dev/sda")]),s._v("\nGNU Parted 3.2\nUsing /dev/sda\nWelcome to GNU Parted"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" Type "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'help'")]),s._v(" to view a list of commands.\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("parted"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" print "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看分区")]),s._v("\nModel: Msft Virtual Disk "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("scsi"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nDisk /dev/sda: 322GB\nSector size "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 512B/4096B\nPartition Table: msdos\nDisk Flags:\n\nNumber  Start   End    Size   Type      File system  Flags\n 1      1049kB  512MB  511MB  primary   ext2         boot\n 2      513MB   107GB  107GB  extended\n 5      513MB   107GB  107GB  logical                lvm\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("parted"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" resizepart 2 "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 调整 sda2 分区大小")]),s._v("\nEnd?  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("107GB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("? -0 "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 直接充满")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("parted"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" print "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 再次查看")]),s._v("\nModel: Msft Virtual Disk "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("scsi"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nDisk /dev/sda: 322GB\nSector size "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 512B/4096B\nPartition Table: msdos\nDisk Flags:\n\nNumber  Start   End    Size   Type      File system  Flags\n 1      1049kB  512MB  511MB  primary   ext2         boot\n 2      513MB   322GB  322GB  extended\n 5      513MB   107GB  107GB  logical                lvm\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("parted"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" q "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 完成退出")]),s._v("\nInformation: You may need to update /etc/fstab.\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br")])]),t("p",[s._v("现在我们已经把 /dev/sda2 给拓展出来了")]),s._v(" "),t("h1",{attrs:{id:"新增-lvm-逻辑分区"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#新增-lvm-逻辑分区","aria-hidden":"true"}},[s._v("#")]),s._v(" 新增 LVM 逻辑分区")]),s._v(" "),t("p",[s._v("运行命令")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@vm003:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# fdisk /dev/sda")]),s._v("\n\nWelcome to "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("fdisk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("util-linux 2.27.1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\nChanges will remain "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" memory only, "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("until")]),s._v(" you decide to "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("write")]),s._v(" them.\nBe careful before using the "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("write")]),s._v(" command.\n\n\nCommand "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("m "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" help"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": p "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看现在的分区情况")]),s._v("\nDisk /dev/sda: 300 GiB, 322122547200 bytes, 629145600 sectors\nUnits: sectors of 1 * 512 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 512 bytes\nSector size "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 512 bytes / 4096 bytes\nI/O size "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum/optimal"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 4096 bytes / 4096 bytes\nDisklabel type: dos\nDisk identifier: 0xa88f1366\n\nDevice     Boot   Start       End   Sectors   Size Id Type\n/dev/sda1  *       2048    999423    997376   487M 83 Linux\n/dev/sda2       1001470 629145599 628144130 299.5G  5 Extended\n/dev/sda5       1001472 209713151 208711680  99.5G 8e Linux LVM\n\nPartition 2 does not start on physical sector boundary.\n\nCommand "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("m "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" help"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新增分区，选择逻辑分区，起止点看情况输入，默认值是填充满整个磁盘")]),s._v("\n\nAll space "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" primary partitions is "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" use.\nAdding logical partition 6\nFirst sector "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("209715200-629145599, default 209715200"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":\nLast sector, +sectors or +size"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("K,M,G,T,P"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("209715200-629145599, default 629145599"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":\n\nCreated a new partition 6 of "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("type")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Linux'")]),s._v(" and of size 200 GiB.\n\nCommand "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("m "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" help"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": p "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看新增的分区")]),s._v("\nDisk /dev/sda: 300 GiB, 322122547200 bytes, 629145600 sectors\nUnits: sectors of 1 * 512 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 512 bytes\nSector size "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 512 bytes / 4096 bytes\nI/O size "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum/optimal"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 4096 bytes / 4096 bytes\nDisklabel type: dos\nDisk identifier: 0xa88f1366\n\nDevice     Boot     Start       End   Sectors   Size Id Type\n/dev/sda1  *         2048    999423    997376   487M 83 Linux\n/dev/sda2         1001470 629145599 628144130 299.5G  5 Extended\n/dev/sda5         1001472 209713151 208711680  99.5G 8e Linux LVM\n/dev/sda6       209715200 629145599 419430400   200G 83 Linux\n\nPartition 2 does not start on physical sector boundary.\n\nCommand "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("m "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" help"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": t "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 改变分区类型为 Linux LVM")]),s._v("\nPartition number "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("1,2,5,6, default 6"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 6 "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sda6")]),s._v("\nPartition "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("type")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("type L to list all types"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 8e "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# LVM 类型的 Id 代码")]),s._v("\n\nChanged "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("type")]),s._v(" of partition "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Linux'")]),s._v(" to "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Linux LVM'")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(".")]),s._v("\n\nCommand "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("m "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" help"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": p "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 再次查看分区情况")]),s._v("\nDisk /dev/sda: 300 GiB, 322122547200 bytes, 629145600 sectors\nUnits: sectors of 1 * 512 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 512 bytes\nSector size "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 512 bytes / 4096 bytes\nI/O size "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum/optimal"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 4096 bytes / 4096 bytes\nDisklabel type: dos\nDisk identifier: 0xa88f1366\n\nDevice     Boot     Start       End   Sectors   Size Id Type\n/dev/sda1  *         2048    999423    997376   487M 83 Linux\n/dev/sda2         1001470 629145599 628144130 299.5G  5 Extended\n/dev/sda5         1001472 209713151 208711680  99.5G 8e Linux LVM\n/dev/sda6       209715200 629145599 419430400   200G 8e Linux LVM\n\nPartition 2 does not start on physical sector boundary.\n\nCommand "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("m "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" help"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": wq "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 确认没有问题，保存退出")]),s._v("\n\nThe partition table has been altered.\nCalling ioctl"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" to re-read partition table.\nRe-reading the partition table failed.: Device or resource busy\n\nThe kernel still uses the old table. The new table will be used at the next "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("reboot")]),s._v(" or after you run partprobe"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("8"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" or kpartx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("8"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br"),t("span",{staticClass:"line-number"},[s._v("76")]),t("br")])]),t("h2",{attrs:{id:"新分区合并到相应-volumn-group"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#新分区合并到相应-volumn-group","aria-hidden":"true"}},[s._v("#")]),s._v(" 新分区合并到相应 Volumn Group")]),s._v(" "),t("p",[s._v("运行命令")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@vm003:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vgdisplay")]),s._v("\n  --- Volume group ---\n  VG Name               Ubuntu\n  System ID\n  Format                lvm2\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("可以看出我们要操作的VG Name 为 "),t("strong",[s._v("Ubuntu")]),s._v("，记录下来。\n接着运行命令")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@vm003:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vgextend Ubuntu /dev/sda6 # /dev/sda6 是刚刚增加的 LVM 分区")]),s._v("\n  Device /dev/sda6 not found "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("or ignored by filtering"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\n  Unable to "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" physical volume "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/dev/sda6'")]),s._v(" to volume group "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Ubuntu'")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(".")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("呃，，，提示没有找到 "),t("em",[s._v("/dev/sda6")]),s._v(" 这个设备，还是重启一下好了。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@vm003:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# reboot")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("重启后再次执行")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@vm003:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vgextend Ubuntu /dev/sda6 # /dev/sda6 是刚刚增加的 LVM 分区")]),s._v("\n  Physical volume "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/dev/sda6"')]),s._v(" successfully created\n  Volume group "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Ubuntu"')]),s._v(" successfully extended\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("再查看一下 Volumn Group 的状态，运行命令")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@vm003:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vgs")]),s._v("\n  VG     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#PV #LV #SN Attr   VSize   VFree")]),s._v("\n  Ubuntu   2   2   0 wz--n- 299.52g 200.00g\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("确实加进去了。\n然后运行")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@vm003:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lvdisplay")]),s._v("\n  --- Logical volume ---\n  LV Path                /dev/Ubuntu/root\n  LV Name                root\n  VG Name                Ubuntu\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("我们知道了 "),t("em",[s._v("Ubuntu")]),s._v(" VG 的 LV Path 是 "),t("strong",[s._v("/dev/Ubuntu/root")]),s._v("，记录下来。\n然后运行")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@vm003:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lvresize -l +100%FREE /dev/Ubuntu/root # /dev/Ubuntu/root 是 LV Path")]),s._v("\n  Size of logical volume Ubuntu/root changed from 95.52 GiB "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("24453 extents"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" to 295.52 GiB "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("75652 extents"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\n  Logical volume root successfully resized.\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("这就成功啦。")]),s._v(" "),t("blockquote",[t("p",[s._v("警告： 如果操作时出现下面这样的 warning，就说明现在 logic volumn 的总大小还不对，resize 不但不增加空间，反而在缩小空间，如果继续操作下去，必将丢失数据。应立即停止！按 n 取消。")])]),s._v(" "),t("blockquote",[t("p",[s._v("WARNING: Reducing active and open logical volume to 32.00 MiB\nTHIS MAY DESTROY YOUR DATA (filesystem etc.)\nDo you really want to reduce root? [y/n]*")])]),s._v(" "),t("h2",{attrs:{id:"更新文件系统"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#更新文件系统","aria-hidden":"true"}},[s._v("#")]),s._v(" 更新文件系统")]),s._v(" "),t("p",[s._v("最后一步，运行命令")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@vm003:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# resize2fs -p /dev/mapper/Ubuntu-root # /dev/mapper/Ubuntu-root 是从 df 命令看到的文件系统信息")]),s._v("\nresize2fs 1.42.13 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("17-May-2015"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nFilesystem at /dev/mapper/Ubuntu-root is mounted on /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" on-line resizing required\nold_desc_blocks "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 6, new_desc_blocks "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 19\n\nThe filesystem on /dev/mapper/Ubuntu-root is now 77467648 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("4k"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" blocks long.\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("这个过程可能会花几分钟时间，耐心等待就好了。\n然后运行 df 命令查看磁盘使用")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@vm003:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# df -h")]),s._v("\nFilesystem               Size  Used Avail Use% Mounted on\nudev                     3.9G     0  3.9G   0% /dev\ntmpfs                    798M  8.6M  789M   2% /run\n/dev/mapper/Ubuntu-root  291G   88G  191G  32% /\ntmpfs                    3.9G     0  3.9G   0% /dev/shm\ntmpfs                    5.0M     0  5.0M   0% /run/lock\ntmpfs                    3.9G     0  3.9G   0% /sys/fs/cgroup\n/dev/sda1                472M  382M   66M  86% /boot\ntmpfs                    100K     0  100K   0% /run/lxcfs/controllers\ntmpfs                    798M     0  798M   0% /run/user/0\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("大功告成！")]),s._v(" "),t("h2",{attrs:{id:"参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考","aria-hidden":"true"}},[s._v("#")]),s._v(" 参考")]),s._v(" "),t("p",[t("a",{attrs:{href:"http://luqitao.github.io/2015/12/08/Resize-Image-Rootpartition/",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://luqitao.github.io/2015/12/08/Resize-Image-Rootpartition/"),t("OutboundLink")],1)])])},[],!1,null,null,null);n.default=e.exports}}]);